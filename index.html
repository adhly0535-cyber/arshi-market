<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
</head>
<body>

<h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ø¨Ø± Google</h2>
<button id="loginBtn" type="button">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>

<p id="status" style="margin-top:10px;font-weight:bold;"></p>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import {
    getAuth,
    GoogleAuthProvider,
    signInWithRedirect,
    getRedirectResult,
    setPersistence,
    browserLocalPersistence,
    onAuthStateChanged
  } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyD3hAvhSDs-lX7ORCOR0DODT3l_S_gJA2o",
    authDomain: "arshi-market.firebaseapp.com",
    projectId: "arshi-market",
    storageBucket: "arshi-market.appspot.com",
    messagingSenderId: "930764899868",
    appId: "1:930764899868:web:06795817be84f0a68a01d9"
  };

  // ØªØ´ØºÙŠÙ„ Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  const loginBtn = document.getElementById("loginBtn");
  const status = document.getElementById("status");

  // ØªØ«Ø¨ÙŠØª Ø§Ù„Ø¬Ù„Ø³Ø© (Ù…Ù‡Ù… Ø¬Ø¯Ù‹Ø§)
  await setPersistence(auth, browserLocalPersistence);

  // Ø²Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  loginBtn.onclick = () => {
    status.textContent = "â³ Ø¬Ø§Ø±ÙŠ ÙØªØ­ Google...";
    signInWithRedirect(auth, provider);
  };

  // Ù‡Ø°Ø§ Ø§Ù„Ø³Ø·Ø± Ù„Ù„Ø£Ù…Ø§Ù† ÙÙ‚Ø· (Ù…Ø´ Ø£Ø³Ø§Ø³ÙŠ)
  await getRedirectResult(auth);

  // ðŸ”´ Ø§Ù„Ø­Ù„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ: Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹ Ù„Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
  onAuthStateChanged(auth, (user) => {
    if (user) {
      status.textContent = "âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­ÙˆÙŠÙ„...";
      window.location.replace("country.html");
    }
  });
</script>

</body>
</html>
